{% extends "base.html" %}

{% set active_page = "admincentre" %}

{% block content %}

<div style="width: 100%; height:100%;">
    <div style="width: 80%; height:100%; margin-left: 10%;">

        <button onclick="openAddProductOverlay()" style="width:200px; height:50px; margin-left:87%; background-color:#FFDA1A; border-radius: 10px; cursor: pointer; border-color:#FFDA1A; font-size: 20px; font-weight: bold; outline: none;">Add New Product</button>

        <div style="width: 100%; height:80%; display:flex; flex-wrap: wrap; flex-direction: row; align-content: flex-start; padding-top: 10px;">

            {% for item in products %}
    
                <div class="card" style="width: 18rem; margin-right: 10px; margin-bottom: 10px;">
    
                    <img class="card-img-top" src="{{item['productUrl']}}" alt="{{item['name']}} image">
    
                    <div class="card-body">
    
                        <h5 class="card-title">{{item['name']}} - Â£{{item['price']}}</h5>
    
                        <p class="card-text">{{item['desc']}}</p>

                        <button type="button" onclick="openEditProductOverlay()" class="btn btn-primary border-0" style="width: 100%; outline:none; background-color:#FFDA1A; color:#000000">EDIT</button>
                        
                    </div>
                </div>
    
            {% endfor %}
    
        </div>

    </div>
</div>

<div id="productInputOverlay" style="position:fixed; display: none; width: 100%; height:100%; top:0; left:0; right:0; bottom:0; background-color: rgba(0,0,0,0.5); z-index: 1031; align-items: center; justify-content: center;">

    <div id="productInputWrapper" style="position:relative; width:480px; height:600px; background-color: white; border-radius:10px">

        <img src="https://i.imgur.com/l9ziZ90.png" alt="" style="width:30px; height:30px; position: absolute; top:10px; right:10px; cursor: pointer;" onclick="closeAddProductOverlay()"/>
            
            <div id="productInputContainer" style="width:80%; height:100%; margin-left: 10%;">

                <div style="width:100%; height:100%;">

                    <h2 id="productInputHeader" style="width:100%; text-align: center; padding-top:5%;">New Product</h2>

                    <form id="productForm" style="width:100%; display:flex; flex-direction:column; margin-top:20px" method="POST">
                        
                        <label style="margin-bottom:0;">Product Code:</label>
                        <input name="productCodeInput" style="height:40px; border-radius: 5px; outline:none; padding-left:10px; cursor:text;" placeholder="Enter Product Code (required)" type="text" required/>

                        <label style="margin-bottom:0; margin-top:3%">Product Name:</label>
                        <input name="productNameInput" style="height:40px; border-radius: 5px; outline:none; padding-left:10px; cursor:text;" placeholder="Enter Product Name (required)" type="text" required/>

                        <label style="margin-bottom:0; margin-top:3%">Description:</label>
                        <textarea name="ProductDescInput" style="height:80px; border-radius: 5px; outline:none; padding-left:10px; padding-right:10px; resize: none; cursor:text;" placeholder="Enter Product Description"></textarea>
                        
                        <div style ="display: flex; flex-direction: row;  margin-top:3%; align-items: center;">
                            <label style="margin-bottom:0; width:120px">Product Image:</label>
                            <input type="file" accept="image/*" id="productImageUpload" hidden/>
                            <label for="productImageUpload" style="height:40px; width:40%; border-radius: 5px; cursor: pointer; background-color:#0051BA; color:#ffffff; font-size: 20px; border:0px; outline:none; display: flex; justify-content: center; align-items: center; margin-bottom:0;">Upload a File</label>
                            <label id="file-chosen" style="font-size:15px; margin-bottom:0; margin-left:10px; width:100px; overflow: hidden; text-overflow: ellipsis;">No file chosen</label>
                        </div>

                        <label style="margin-bottom:0; margin-top:3%">Product Price:</label>
                        <input name="productPriceInput" style="height:40px; border-radius: 5px; outline:none; padding-left:10px; cursor:text;" placeholder="Enter Product Price (required)" type="number" step="0.01" required/>

                        <button id="createProduct_btn" onclick="" style="display:none; width:80%; height:50px; margin-left: 10%; margin-top:5%; border-radius: 10px; cursor: pointer; background-color:#0051BA; color:#ffffff; font-size: 25px; border:0px; outline:none;">Create</button>
                        <button id="updateProduct_btn" onclick="" style="display:none; width:80%; height:50px; margin-left: 10%; margin-top:5%; border-radius: 10px; cursor: pointer; background-color:#0051BA; color:#ffffff; font-size: 25px; border:0px; outline:none;">Update</button>
                        
                        <div style="display: flex; justify-content: center; margin-top: 2%;">
                            <label id="productError"></label>
                        </div>
                    
                    </form>
                    
                </div>

            </div>

    </div>

</div>

<script>

    const actualBtn = document.getElementById('productImageUpload');

    const fileChosen = document.getElementById('file-chosen');

    actualBtn.addEventListener('change', function(){
    fileChosen.textContent = this.files[0].name
    })

</script>

<script>

    function openAddProductOverlay() {
        document.getElementById("productInputHeader").innerHTML = "Add Product"
        document.getElementById("productInputOverlay").style.display = "flex";

        document.getElementById("createProduct_btn").style.display = "block";
        document.getElementById("updateProduct_btn").style.display = "none";

        document.getElementById("productForm").action = "/admin/create";

    }
    
    function closeAddProductOverlay() {
      document.getElementById("productInputOverlay").style.display = "none";
    }

    function openEditProductOverlay() {
        document.getElementById("productInputHeader").innerHTML = "Update Product"
        document.getElementById("productInputOverlay").style.display = "flex";

        document.getElementById("createProduct_btn").style.display = "none";
        document.getElementById("updateProduct_btn").style.display = "block";
    }

</script>

{% endblock %}
